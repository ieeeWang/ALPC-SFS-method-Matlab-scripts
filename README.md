# ALPC-SFS-method-Matlab-scripts
the Matlab scripts for the ALPC-SFS method proposed in our published paper on Scientific Reports:  

**Estimating multiple latencies in the auditory system from auditory steady-state responses on a single EEG channel**
The paper can be found [here](https://www.nature.com/articles/s41598-021-81232-5#additional-information).

Firstly, add the 'utilits' folder under the MATLAB path:
```
utilits_dir = 'your_own_foler_path\';
addpath(utilits_dir);
```

The three example simulations in this paper were generated by using the following scripts respectively:
```
ALPC_simulation_Example1.m 
ALPC_simulation_Example2.m
ALPC_simulation_Example3.m
```

A demo (Fig.4) of results of ALPC_simulation_Example1.m:

<p align="center">
    <img width="200%" src="images/Fig4.png" style="max-width:200%;"></a>
</p>

Simulation of the ALPC-SFS method for the system of Eq. (11). The two subsystems were successfully separated from the mixed nonlinear response, and their latencies were estimated correctly. (a) Input signal X (sum of five cosine signals with zero phases) and their mixed total response, Y. (b) SFS without applying the termination criterion. Each circle represents a candidate frequency and the dashed line crosses the candidate frequencies with the minimum MPE for each step (top panel) and their corresponding latencies (bottom panel). (c) Phase error (PE, in radians) of each selected frequency over time. The MPE (bold dashed line) reaches its minimum (close to 0) at the estimated latency. (d) Plot of phase lags determined from the estimated latency. The slopes of the best-fit lines correspond to the latencies.




